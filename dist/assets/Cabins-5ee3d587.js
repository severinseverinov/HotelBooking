import{s as S,N as x,W as P,_ as v,j as t,d as e,B as q,f as A,M as u,X as K,Y as Q,J as z,K as X,u as Z,S as _,V as $,F as J,y as M,q as L}from"./index-5b5dd1dc.js";import{u as Y}from"./index.esm-924f81ee.js";import{F as G,a as f,I as w}from"./FormRow-3f426176.js";import{F as U}from"./FileInput-241b54d6.js";import{c as N,d as ee,u as ie}from"./useCabins-7448ffbf.js";import{T as F,M as g,a as ae,S as ne}from"./TableOperations-91504400.js";import{F as re}from"./Filter-f4936fd5.js";const te=S.textarea`
  padding: 0.8rem 1.2rem;
  border: 1px solid var(--color-grey-300);
  border-radius: 5px;
  background-color: var(--color-grey-0);
  box-shadow: var(--shadow-sm);
  width: 100%;
  height: 8rem;
`;function k(){const l=x(),{mutate:i,isPending:s}=P({mutationFn:N,onSuccess:()=>{v.success("New cabin successfully created"),l.invalidateQueries({queryKey:["cabins"]})},onError:a=>v.error(a.message)});return{isCreating:s,createCabin:i}}function se(){const l=x(),{mutate:i,isPending:s}=P({mutationFn:({newCabinData:a,id:c})=>N(a,c),onSuccess:()=>{v.success("Cabin successfully edited"),l.invalidateQueries({queryKey:["cabins"]})},onError:a=>v.error(a.message)});return{editNewCabin:i,isEditing:s}}function I({editCabin:l={},onClose:i}){var D,T,E,R,B;const{id:s,...a}=l,c=!!s,{createCabin:p,isCreating:m}=k(),{editNewCabin:y,isEditing:b}=se(),{register:d,handleSubmit:r,reset:C,getValues:W,formState:j}=Y({defaultValues:c?a:{}}),{errors:n}=j,h=m||b;function H(o){const V=typeof o.image=="string"?o.image:o.image[0];c?y({newCabinData:{...o,image:V},id:s},{onSuccess:()=>{C(),i==null||i()}}):p({...o,image:V},{onSuccess:()=>{C(),i==null||i()}})}function O(o){console.log(o)}return t(G,{onSubmit:r(H,O),type:i?"modal":"regular",children:[e(f,{label:"Cabin name",error:(D=n==null?void 0:n.name)==null?void 0:D.message,children:e(w,{type:"text",id:"name",disabled:h,...d("name",{required:"This Field is Required"})})}),e(f,{label:"Maximum Capacity",error:(T=n==null?void 0:n.maxCapacity)==null?void 0:T.message,children:e(w,{type:"number",id:"maxCapacity",disabled:h,...d("maxCapacity",{required:"This Field is Required",min:{value:1,message:"Capacity should be at least 1"}})})}),e(f,{label:"Regular Price",error:(E=n==null?void 0:n.regularPrice)==null?void 0:E.message,children:e(w,{type:"number",id:"regularPrice",disabled:h,...d("regularPrice",{required:"This Field is Required",min:{value:1,message:"Value should be higher than 0"}})})}),e(f,{label:"Discount",error:(R=n==null?void 0:n.discount)==null?void 0:R.message,children:e(w,{type:"number",id:"discount",defaultValue:0,disabled:h,...d("discount",{required:"This Field is Required",validate:o=>o<W().regularPrice||"Discount should be less than regular price"})})}),e(f,{label:"Description for website",disabled:h,error:(B=n==null?void 0:n.description)==null?void 0:B.message,children:e(te,{type:"number",id:"description",defaultValue:"",disabled:h,...d("description",{required:"This Field is Required"})})}),e(f,{label:"Cabin Photo",children:e(U,{id:"image",accept:"image/*",...d("image",{required:c?!1:"This Field is Required"})})}),t(f,{children:[e(q,{variation:"secondary",type:"reset",onClick:()=>i==null?void 0:i(),children:"Cancel"}),t(q,{disabled:h,children:[c?"Edit cabin":"Add cabin"," "]})]})]})}function ce(){const l=x(),{isPending:i,mutate:s}=P({mutationFn:ee,onSuccess:()=>{v.success("Cabin successfully deleted"),l.invalidateQueries({queryKey:["cabins"]})},onError:a=>v.error(a.message)});return{isDeleting:i,deleteCabin:s}}const le=S.img`
  display: block;
  margin-left: 5px;
  width: 6.4rem;
  aspect-ratio: 3 / 2;
  object-fit: cover;
  object-position: center;
  transform: scale(1.5) translateX(-7px);
`,de=S.div`
  font-size: 1.6rem;
  font-weight: 600;
  color: var(--color-grey-600);
  font-family: "Sono";
`,oe=S.div`
  font-family: "Sono";
  font-weight: 600;
`,ue=S.div`
  font-family: "Sono";
  font-weight: 500;
  color: var(--color-green-700);
`;function me({cabin:l}){const{isDeleting:i,deleteCabin:s}=ce(),{isCreating:a,createCabin:c}=k(),{name:p,maxCapacity:m,regularPrice:y,discount:b,image:d,id:r}=l;function C(){c({name:`copy of ${p} cabin`,maxCapacity:m,regularPrice:y,discount:b,image:d})}return t(F.Row,{children:[e(le,{src:d}),e(de,{children:p}),t("div",{children:["Fits up to ",m," guests"]}),e(oe,{children:A(y)}),b?e(ue,{children:A(b)}):e("span",{children:"â€”"}),e("div",{children:e(u,{children:t(g.Menu,{children:[e(g.Toggle,{id:r}),t(g.List,{id:r,children:[e(g.Button,{icon:e(K,{}),onClick:C,disabled:a,children:"Duplicate"}),e(u.Open,{opens:"edit",children:e(g.Button,{icon:e(Q,{}),children:"Edit"})}),e(u.Open,{opens:"delete",children:e(g.Button,{icon:e(z,{}),children:"Delete"})})]}),e(u.Window,{name:"edit",children:e(I,{editCabin:l})}),e(u.Window,{name:"delete",children:e(X,{resourceName:"cabins",disabled:i,onConfirm:()=>s(r)})})]})})})]})}function be(){const{isPending:l,cabins:i}=ie(),[s]=Z();if(l)return e(_,{});if(!i.length)return e($,{resourceName:"Cabins"});const a=s.get("discount")||"all";let c;a==="all"&&(c=i),a==="no-discount"&&(c=i.filter(r=>r.discount===0)),a==="with-discount"&&(c=i.filter(r=>r.discount>0));const p=s.get("sortBy")||"startDate-asc",[m,y]=p.split("-"),b=y==="asc"?1:-1,d=c.sort((r,C)=>(r[m]-C[m])*b);return e(g,{children:t(F,{columns:"0.6fr 1.8fr 2.2fr 1fr 1fr 1fr",children:[t(F.Header,{children:[e("div",{children:"Image"}),e("div",{children:"Cabin"}),e("div",{children:"Capacity"}),e("div",{children:"Price"}),e("div",{children:"Discount"})]}),e(F.Body,{data:d,render:r=>e(me,{cabin:r},r.id)})]})})}function he(){return e("div",{children:t(u,{children:[e(u.Open,{opens:"cabin-form",children:e(q,{children:"Add new cabin"})}),e(u.Window,{name:"cabin-form",children:e(I,{})})]})})}function fe(){return t(ae,{children:[e(re,{filterField:"discount",options:[{value:"all",label:"All"},{value:"no-discount",label:"No discount"},{value:"with-discount",label:"With discount"}]}),e(ne,{options:[{value:"name-asc",label:"Sort by name (A-Z)"},{value:"name-desc",label:"Sort by name (Z-A)"},{value:"regularPrice-asc",label:"Sort by price (low first)"},{value:"regularPrice-desc",label:"Sort by price (high first)"},{value:"maxCapacity-asc",label:"Sort by capacity (low first)"},{value:"maxCapacity-desc",label:"Sort by capacity (high first)"}]})]})}function Fe(){return t(J,{children:[t(M,{type:"horizontal",children:[e(L,{as:"h1",children:"All cabins"}),e(fe,{})]}),t(M,{children:[e(be,{}),e(he,{})]})]})}export{Fe as default};
