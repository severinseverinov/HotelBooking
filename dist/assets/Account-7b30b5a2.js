import{N as S,W as v,a8 as N,_ as U,a9 as q,r as b,j as i,d as e,B as m,F as x,q as g,y as C}from"./index-5b5dd1dc.js";import{F as P}from"./FileInput-241b54d6.js";import{F,a as n,I as p}from"./FormRow-3f426176.js";import{S as j}from"./SpinnerMini-207b3d18.js";import{u as A}from"./index.esm-924f81ee.js";function y(){const d=S(),{mutate:o,isPending:u}=v({mutationFn:N,onSuccess:({user:a})=>{U.success("User successfully updated"),d.setQueryData(["user"],a)},onError:a=>U.error(a.message)});return{updateUser:o,isUpdating:u}}function D(){const{user:{email:d,user_metadata:{fullName:o}}}=q(),{updateUser:u,isUpdating:a}=y(),[l,s]=b.useState(o),[h,t]=b.useState(null);function f(r){r.preventDefault(),l&&u({fullName:l,avatar:h},{onSuccess:()=>{t(null),r.target.reset()}})}function c(){s(o),t(null)}return i(F,{onSubmit:f,children:[e(n,{label:"Email address",children:e(p,{value:d,disabled:!0})}),e(n,{label:"Full name",children:e(p,{type:"text",value:l,onChange:r=>s(r.target.value),id:"fullName",disabled:a})}),e(n,{label:"Avatar image",children:e(P,{id:"avatar",accept:"image/*",onChange:r=>t(r.target.files[0]),disabled:a})}),i(n,{children:[e(m,{type:"reset",variation:"secondary",onClick:c,children:"Cancel"}),a?e(j,{}):e(m,{children:"Update account"})]})]})}function E(){var c,r;const{register:d,handleSubmit:o,formState:u,getValues:a,reset:l}=A(),{errors:s}=u,{updateUser:h,isUpdating:t}=y();function f({password:w}){h({password:w},{onSuccess:l})}return i(F,{onSubmit:o(f),children:[e(n,{label:"New password (min 8 chars)",error:(c=s==null?void 0:s.password)==null?void 0:c.message,children:e(p,{type:"password",id:"password",autoComplete:"current-password",disabled:t,...d("password",{required:"This field is required",minLength:{value:8,message:"Password needs a minimum of 8 characters"}})})}),e(n,{label:"Confirm password",error:(r=s==null?void 0:s.passwordConfirm)==null?void 0:r.message,children:e(p,{type:"password",autoComplete:"new-password",id:"passwordConfirm",disabled:t,...d("passwordConfirm",{required:"This field is required",validate:w=>a().password===w||"Passwords need to match"})})}),i(n,{children:[e(m,{onClick:l,type:"reset",variation:"secondary",children:"Cancel"}),e(m,{disabled:t,children:"Update password"})]})]})}function M(){return i(x,{children:[e(g,{as:"h1",children:"Update your account"}),i(C,{children:[e(g,{as:"h3",children:"Update user data"}),e(D,{})]}),i(C,{children:[e(g,{as:"h3",children:"Update password"}),e(E,{})]})]})}export{M as default};
